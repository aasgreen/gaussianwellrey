(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    132048,       3672]
NotebookOptionsPosition[    124750,       3437]
NotebookOutlinePosition[    125186,       3454]
CellTagsIndexPosition[    125143,       3451]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["-"], "Input",
 CellChangeTimes->{3.5757335259284163`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.573813110385186*^9, 3.573813111418289*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Want", " ", "to", " ", "find", " ", "the", " ", "onsite", " ", 
    "interaction", " ", "of", " ", "the", " ", 
    RowBox[{"system", ".", " ", "Remember"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "want", " ", "to", " ", "build", " ", "an", " ", "effective", 
     " ", "bose"}], "-", 
    RowBox[{"hubbard", " ", 
     RowBox[{"hamiltonian", "."}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.573813168198083*^9, 3.573813202715317*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", ",", " ", 
    RowBox[{
    "define", " ", "and", " ", "test", " ", "a", " ", "wannier", " ", 
     "function", " ", 
     RowBox[{"function", ".", " ", "Find"}], " ", "the", " ", "vectors", " ", 
     "first"}], ",", " ", 
    RowBox[{
    "as", " ", "that", " ", "will", " ", "save", " ", "dramatic", " ", 
     "amounts", " ", "of", " ", 
     RowBox[{"time", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.573813214279205*^9, 3.5738132605317464`*^9}, {
  3.573813311114704*^9, 3.573813311189253*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5738132296563063`*^9, 3.5738132329626303`*^9}, {
  3.5738132666161337`*^9, 3.5738132691414495`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Wannier", " ", "Process", " ", "1", "D"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1.", " ", "Find", " ", "eigenvectors", " ", "L"}], "=", "12"}], 
    ",", " ", 
    RowBox[{"c", "=", ".5"}], ",", 
    RowBox[{"V", "=", "10"}], ",", " ", 
    RowBox[{"b", "=", "2"}], ",", " ", 
    RowBox[{"p", "=", "45"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "12"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", ".5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "45"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WE", " ", "=", " ", 
     RowBox[{"computePlaneMatrix2Well", "[", 
      RowBox[{"V", ",", "c", ",", "b", ",", "L", ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"WE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "10000"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"groundState1D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"WE", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "12", ",", "x"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{"take", " ", "the", " ", "eigenvectors"}], ",", " ", 
     RowBox[{
     "and", " ", "build", " ", "the", " ", "wannier", " ", "functions"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WigPsi0", " ", "[", "x_", "]"}], " ", "=", " ", 
     RowBox[{"groundState1D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WE", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "12", ",", "x"}], "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"WigPsi1", "[", "x_", "]"}], " ", "=", " ", 
     RowBox[{"groundState1D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WE", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "12", ",", "x"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "normalization", " ", "of", " ", "the", " ", "ground", " ", 
     "and", " ", "excite", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Wig1", " ", "[", "x_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"Wig1", "[", "x", "]"}], "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "+", 
         RowBox[{"Im", "[", 
          RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
       RowBox[{"Sqrt", "[", "2", "]"}]]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Wig2", " ", "[", "x_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"Wig2", "[", "x", "]"}], "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "-", 
         RowBox[{"Im", "[", 
          RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
       RowBox[{"Sqrt", "[", "2", "]"}]]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.573813271611116*^9, 3.573813386021856*^9}, {
  3.5738134183235035`*^9, 3.573813420776107*^9}, {3.5738134543457675`*^9, 
  3.573813473515758*^9}, {3.573813633786095*^9, 3.573813691815322*^9}, {
  3.573813779181828*^9, 3.5738138055290823`*^9}, {3.573814395429642*^9, 
  3.5738144468142524`*^9}, {3.5739015443516407`*^9, 3.5739016199481163`*^9}, {
  3.5739016966237297`*^9, 3.573901746678586*^9}, {3.5739018243716946`*^9, 
  3.573901827714117*^9}, {3.573901928733551*^9, 3.573901940813065*^9}, {
  3.573904098909551*^9, 3.573904098951551*^9}, {3.573904586266533*^9, 
  3.573904647445512*^9}}],

Cell[BoxData["a"], "Input",
 CellChangeTimes->{3.573918124349687*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Wig1", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], ";", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{"WigPsi1", "[", "x", "]"}], "]"}], "2"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "6"}], ",", "6"}], "}"}]}], "]"}], ";", "\n", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Wig1", "[", "x", "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{"Wig2", "[", "x", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5739017203196993`*^9, 3.5739017589301214`*^9}, {
  3.5739018007772946`*^9, 3.573901807270113*^9}, {3.573901841047785*^9, 
  3.5739019061367207`*^9}, {3.573902145273822*^9, 3.573902170557974*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", ",", " ", 
   RowBox[{"calculate", " ", "the", " ", "onsite", " ", "interaction"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5739021729062686`*^9, 3.573902180839261*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.573904650903943*^9, 3.5739046729036703`*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.00002749098953895973`"}]], "Output",
 CellChangeTimes->{{3.5739046548754435`*^9, 3.5739046710094643`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", " ", "=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Wig1", "[", "x", "]"}], "2"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "/", "2"}], ",", 
      RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.573902192590738*^9, 3.5739022417025013`*^9}, {
  3.573904690337306*^9, 3.5739046969051337`*^9}, {3.5739047953596663`*^9, 
  3.5739048086569214`*^9}, {3.573918148681839*^9, 3.573918148849093*^9}}],

Cell[BoxData["1.0000000079282643`"], "Output",
 CellChangeTimes->{
  3.573902243006668*^9, 3.573918103421011*^9, {3.573918144931205*^9, 
   3.573918149664114*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", " ", "=", " ", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Wig2", "[", "x", "]"}], "4"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "/", "2"}], ",", 
      RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.573902245047924*^9, 3.5739022631400394`*^9}, {
  3.573904698522755*^9, 3.5739047026702747`*^9}}],

Cell[BoxData["0.8885394007134075`"], "Output",
 CellChangeTimes->{3.573902263626096*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Calculate", " ", "the", " ", "tunneling", " ", "rates"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5739022701689167`*^9, 3.573902276506054*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"WE", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "-", 
   RowBox[{
    RowBox[{"WE", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.573902278954359*^9, 3.573902303673458*^9}}],

Cell[BoxData["0.0000637181474303361`"], "Output",
 CellChangeTimes->{3.5739023041865253`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LatticeVector", " ", "=", " ", "b"}]], "Input",
 CellChangeTimes->{{3.574008359497445*^9, 3.574008362233897*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5740083626483297`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "the", " ", "Raman", " ", "assisted", " ", "tunneling", 
    " ", 
    RowBox[{"rates", ".", " ", "Come"}], " ", "back", " ", "to", " ", "this", 
    " ", 
    RowBox[{"later", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LatticeVector", " ", "=", " ", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"site", " ", "of", " ", "well"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LatticeVector", " ", "=", "b"}], "\[IndentingNewLine]", 
   RowBox[{"K", " ", "=", 
    RowBox[{"Manipulate", "[", " ", 
     RowBox[{
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"Wig1", "[", "x", "]"}], "]"}], "*", 
         RowBox[{"Wig2", "[", "x", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "12"], "*", "y", "*", 
             RowBox[{"(", 
              RowBox[{"x", "+", "LatticeVector"}], ")"}]}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "L"}], "/", "2"}], ",", 
          RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", ".1", ",", "L"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5739023105033145`*^9, 3.573902328260724*^9}, {
  3.5739024526547623`*^9, 3.5739024599366736`*^9}, {3.573902684547598*^9, 
  3.573902705196189*^9}, {3.5739027560828953`*^9, 3.573902803707102*^9}, {
  3.573903188991465*^9, 3.5739032390262337`*^9}, {3.5739033124705114`*^9, 
  3.5739033182561646`*^9}, {3.5739033827972517`*^9, 3.5739033836284294`*^9}, {
  3.5739039955785956`*^9, 3.5739041183923483`*^9}, {3.5739047182404847`*^9, 
  3.573904737111846*^9}}],

Cell[BoxData["2.`"], "Output",
 CellChangeTimes->{3.5739041193254623`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KPlotR", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"Wig1", "[", "x", "]"}], "]"}], "*", 
         RowBox[{"Wig2", "[", "x", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "12"], "*", "y", "*", 
             RowBox[{"(", 
              RowBox[{"x", "+", "LatticeVector"}], ")"}]}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "L"}], "/", "2"}], ",", 
          RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", ".1", ",", "L", ",", ".5"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5739033804899645`*^9, 3.5739034429777937`*^9}, {
   3.573903749738787*^9, 3.573903766486881*^9}, {3.5739041720083694`*^9, 
   3.5739041820487037`*^9}, 3.5739042133335485`*^9, {3.573904416667035*^9, 
   3.5739044405801063`*^9}, {3.573904740395777*^9, 3.5739047462305117`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQDQEf7A/PL/rx80OzHVTAQceM98SUzItQPocDW9+r
7UsMb0H5Ag5ufeaa/U3H90H4Ig5B2iHJJU1foXwJhzI3K9sP7oz7IXwZh2TR
VxbPk/9B5RUcoh26Hi8pfAXlKzkYLCs20l42E2q+igPXvZ85U1/thsqrOXTo
zVqunfQeytdw4JxgKKEV/AvK13JI71VYlqr5HcrXcTCKPa0iZPgEytdzYJi9
pVynIAxqvoHD7W1z29582QiVN3QQ/edsXsEAU2/kUPzDSGNZwgco39jh6O1j
D7Ul30D5Jg7vNbevVWe6AeWbOnzaIae4yDAKyjdzsHjN6JBybTGUb+7w8m1x
w7ErV6F8C4ejwTfZQ+Y93AcA9OtxHQ==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.},
  Method->{},
  PlotRange->{{0, 24.}, {-0.00003296090986028021, 6.245117104927965*^-6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.48, 0.48}, {7.841205393041636*^-7, 
   7.841205393041636*^-7}}]], "Output",
 CellChangeTimes->{3.573903416558481*^9, 3.573903651983989*^9, 
  3.573903909620822*^9, 3.5739041405191216`*^9, 3.5739042113643055`*^9, 
  3.5739044110033264`*^9, 3.573904446420768*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KPlotI", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"Wig1", "[", "x", "]"}], "]"}], "*", 
         RowBox[{"Wig2", "[", "x", "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[ImaginaryI]", "*", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "12"], "*", "y", "*", 
             RowBox[{"(", 
              RowBox[{"x", "+", "LatticeVector"}], ")"}]}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "L"}], "/", "2"}], ",", 
          RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", ".1", ",", "L", ",", ".5"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5739037752319775`*^9, 3.573903776169094*^9}, {
  3.573904190968748*^9, 3.573904216044891*^9}, {3.573904464055049*^9, 
  3.573904470743812*^9}, {3.573904751636188*^9, 3.573904757040867*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQDQEf7GP+trzMPxJgBxVwqK1LnWXnexLK53CIPNg0
sT/rLZQv4HBZeFH9ja+/oXwRB63l7bx/Zv2F8iUceGKeW6849g7Kl3Go14ww
nt17ch+Er+BQ/cPOPN/sMZSv5NBh/+XEm7NroOpVHFQvmZpsnvkByldzqK3+
pMg98yuUr+Gw1uuF94eC51C+lkPZa9ewxZWHoebpODAb5syQDL8L5es5LGDL
d9xnlAlVb+CgdvHoLcnop1C+oUPH9OeHdrS/hvKNHJYtsFA7oHUXyjd20LM/
pOe8YDvUPBOHpVssawoLL0L5pg4mDZ06s7JyoXwzhzKG3yFbp1+H6jd3yNg7
T9yL5x6Ub+Hw0aR1XlPCeTsAwFFu0Q==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.},
  Method->{},
  PlotRange->{{0, 24.}, {-9.161298045398184*^-6, 0.000028233917733467392`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.48, 0.48}, {7.479043155773116*^-7, 
   7.479043155773116*^-7}}]], "Output",
 CellChangeTimes->{3.5739039811297836`*^9, 3.5739044803850203`*^9, 
  3.5740083912865877`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Wig2", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.574008416834997*^9, 3.574008432186713*^9}}],

Cell[BoxData["1.1319892163012846`"], "Output",
 CellChangeTimes->{{3.574008420790124*^9, 3.5740084327649593`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["L"], "Input",
 CellChangeTimes->{{3.574008490761939*^9, 3.574008493572997*^9}, 
   3.574008634764512*^9}],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.574008494329276*^9, 3.574008635298671*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5740085104421453`*^9, 3.5740085219345493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KPlotAbs", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Conjugate", "[", 
             RowBox[{"Wig1", "[", "x", "]"}], "]"}], "*", 
            RowBox[{"Wig2", "[", "x", "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[ImaginaryI]", "*", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                FractionBox["\[Pi]", "12"], "*", "y", "*", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "LatticeVector"}], ")"}]}], ")"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{
              RowBox[{"-", "L"}], "/", "2"}], ",", 
             RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", ".1", ",", "L", ",", ".5"}], "}"}]}], "]"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Wavelength of beam in units of spot size\>\"", ",", 
       "\"\<Raman Tunneling\>\""}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.573904496926097*^9, 3.5739045008045025`*^9}, {
  3.5739047607443304`*^9, 3.5739047675291805`*^9}, {3.574008300259204*^9, 
  3.574008312930923*^9}, {3.574008537690641*^9, 3.57400854533844*^9}, {
  3.5740087823318233`*^9, 3.574008885209897*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQAGIQPWsmCOy0XzQxb4YEb4udMRg8tpc8xz7xfutVO4j8
R/uDta/OzZH8AOX/tBc+se2Vq+wfu7NnQIDB4XaJ6QdBHyZ7CJ/FQb3vTd2s
VzA+h8M59/TLB/v+QdXzOHhbRR+/F/7BLg0MBBy2dk3kONK+HsoXckh3Yzol
vREmL+IQKLqSy23TLyhfzKGG/5Lw+wt/oHwJB85crat8Xt+hfCmHzZ9eHAz6
+gLKl3Gws+Bebz41G8qXc1jY80TOvPIp1L8KDsovRD12M3+E8hUd4v9NZ8x9
C+MrOTCdO6d92uENlK/s4C+bfF9g7V0oX8Vh0fWncxZJFkD5qg4xHT+4fu24
DuWrOXQ+Fl4hMekRlK/u4Mg9w1Xb87EdAB0spo4=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"Wavelength of beam in units of spot size\"", TraditionalForm], 
    FormBox["\"Raman Tunneling\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  ImageSize->{593.9999999999999, Automatic},
  Method->{},
  PlotRange->{{0, 11.6}, {0, 0.000036080207669788714`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.23199999999999998`, 0.23199999999999998`}, {
   7.216041533957743*^-7, 7.216041533957743*^-7}}]], "Output",
 CellChangeTimes->{
  3.573904506765252*^9, 3.574008350261023*^9, {3.574008792265744*^9, 
   3.574008807514649*^9}, {3.574008867958476*^9, 3.574008888434376*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", ",", " ", 
   RowBox[{
   "plot", " ", "the", " ", "onsite", " ", "vs", " ", "the", " ", "tunneling",
     " ", "vs", " ", "the", " ", "raman", " ", "tunneling"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5739047737959633`*^9, 3.5739047839852448`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "functionality", " ", "is", " ", "now", " ", "in", " ", 
     "function", " ", "WigMaker"}], ",", " ", 
    RowBox[{
    "which", " ", "will", " ", "create", " ", "the", " ", "wigner", " ", 
     "functions", " ", "for", " ", "a", " ", "given", " ", "set", " ", "of", 
     " ", "specs"}]}], "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"W0", ",", "W1", ",", "EW"}], "}"}], " ", "=", " ", 
    RowBox[{"WigMaker", "[", 
     RowBox[{"10", ",", ".5", ",", "2", ",", "12", ",", "45"}], "]"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"U1", " ", "=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Wig1", "[", "x", "]"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "L"}], "/", "2"}], ",", 
        RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"UList", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{"Onsite", "[", 
         RowBox[{"10", ",", ".5", ",", "b", ",", "12", ",", "45"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "0", ",", "2", ",", ".1"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5739050826922956`*^9, 3.5739052515988436`*^9}, {
  3.5739053895772543`*^9, 3.573905389857236*^9}, {3.573918085285284*^9, 
  3.573918085558689*^9}, {3.5739193054765368`*^9, 3.573919341257193*^9}}],

Cell[BoxData["1.0000000079282643`"], "Output",
 CellChangeTimes->{3.5739193449323587`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.1802999793630347`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "1.165605520605968`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "1.1229298874816314`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.30000000000000004`", ",", "1.0569140929496972`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4`", ",", "0.9765230787893655`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.896260826767791`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", "0.8361696802329868`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", "0.8155412085701649`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8`", ",", "0.8322548939217057`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "0.8581795945395655`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.8751949025145193`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1`", ",", "0.883346248708562`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2000000000000002`", ",", "0.8866927732832407`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3`", ",", "0.8879318851375665`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4000000000000001`", ",", "0.8883529019500152`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5`", ",", "0.888485513934818`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6`", ",", "0.8885246238947113`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7000000000000002`", ",", "0.8885355427176767`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8`", ",", "0.8885384594844017`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9000000000000001`", ",", "0.888539211620774`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.`", ",", "0.8885394007129106`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5739193477305107`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"UList", ",", "JList"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Onsite\>\"", ",", "\"\<Tunneling\>\""}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.573919359944499*^9, 3.573919363741537*^9}, {
  3.573919689009564*^9, 3.573919732106154*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, {{
        RGBColor[0.24720000000000014`, 0.24, 0.6], 
        PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQP3w3Stmx59sp81EwR22vctKvgZuAzGP2n/53Na
SOv3j/YmxiBw2d4po+6A3MsPUPmb9jcEngWvtX9vDzHtgb3GqxJ97XVvoOof
24vYXnj17OAr+/Q0EHhmn6uT/eClxCuo/pf2m3teMV9d+Mr+7BkQeGPP2z2F
17TsNdS8D/ZP59funcH4Bqr+o/3v1+pR8S4w8z/bP7W+3Xoy/g1U/xd73V3f
FT5kvoHa982e7fJSgeTcN1DzftgfsdbSqcyDmffTnsNQy/B0Hsy83/YspzXF
H+XBzPtjf0RD3PRFHsy8f/YH/j0+8TIPZh6Dw415GXqvgHwAtyqgrQ==
         "]]}, {
        RGBColor[0.6, 0.24, 0.4428931686004542], 
        PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQc/Ej4UJcg6zJoJAjvtGQQ84uUmyUD5J+0ZDnD4
lFlLOZgYg8Ble4YJ+TM4ZopB5W/aM/yIaJ3DJ+QAMeyBPQOD6/qLXlxQ9Y/t
GRQmXvTmZHRITwOBZ0DzRORrfD/bQ/S/tGdoiNvHnPbY/uwZEHgD1L9Zfp/5
JXuIeR+A9KQfF44fgKr/COTvcV3+bZ09xPzPQL7F1Hc750D1fwHyN9yPOtxl
D7HvG5DvYNb8rwJq3g8gfaDRLDYdat5PkLif4u1QqHm/wfyAIheoeX9A/DPR
ssZQ8/6B+Fc+vVaEmscA8vcBni0C9gBapH+T
         "]]}}, {}}, {}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> True, 
    AxesLabel -> {None, None}, AxesOrigin -> {0., 0.00006371810741256922}, 
    Method -> {}, PlotRangeClipping -> True],
   TemplateBox[{"\"Onsite\"", "\"Tunneling\""}, "PointLegend", 
    DisplayFunction -> (StyleBox[
      StyleBox[
       PaneBox[
        TagBox[
         GridBox[{{
            TagBox[
             GridBox[{{
                GraphicsBox[{{}, {
                   Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0.24720000000000014`, 0.24, 0.6]], {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0.24720000000000014`, 0.24, 0.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                 ImageSize -> {10, 10}, PlotRangePadding -> None, 
                 ImagePadding -> 1, 
                 BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                GraphicsBox[{{}, {
                   Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0.6, 0.24, 0.4428931686004542]], {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0.6, 0.24, 0.4428931686004542]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                 ImageSize -> {10, 10}, PlotRangePadding -> None, 
                 ImagePadding -> 1, 
                 BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
              GridBoxAlignment -> {
               "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
              AutoDelete -> False, 
              GridBoxDividers -> {
               "Columns" -> {{False}}, "Rows" -> {{False}}}, 
              GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
              GridBoxSpacings -> {"Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], 
             "Grid"]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], "Grid"], 
        Alignment -> Left, AppearanceElements -> None, 
        ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> "ResizeToFit"], 
       LineIndent -> 0, StripOnInput -> False], {FontFamily -> "Times"}, 
      Background -> Automatic, StripOnInput -> False]& ), Editable -> True, 
    InterpretationFunction :> (RowBox[{"PointLegend", "[", 
       RowBox[{
         RowBox[{"{", 
           RowBox[{
             RowBox[{"Directive", "[", 
               RowBox[{"RGBColor", "[", 
                 RowBox[{"0.24720000000000014`", ",", "0.24`", ",", "0.6`"}], 
                 "]"}], "]"}], ",", 
             RowBox[{"Directive", "[", 
               RowBox[{"RGBColor", "[", 
                 RowBox[{"0.6`", ",", "0.24`", ",", "0.4428931686004542`"}], 
                 "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{#, ",", #2}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{
             RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}], ",", 
             RowBox[{"LegendMarkers", "\[Rule]", "False"}]}], "}"}]}], 
       "]"}]& )]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Input",
 CellChangeTimes->{{3.574009768335548*^9, 3.574009770994031*^9}}],

Cell[BoxData[
 RowBox[{"EList", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", 
      RowBox[{
       RowBox[{"WigMaker", "[", 
        RowBox[{"10", ",", ".5", ",", "b", ",", "12", ",", "45"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "0", ",", "2", ",", ".1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.573919538951415*^9, 3.573919608143463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JList", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"EList", "[", 
        RowBox[{"[", "p", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EList", "[", 
          RowBox[{"[", "p", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"EList", "[", 
          RowBox[{"[", "p", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "1", ",", 
      RowBox[{"Length", "[", "EList", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.573919618382082*^9, 3.573919678966609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "7.344188457411292`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "7.142693985722872`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "6.5580684547749115`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.30000000000000004`", ",", "5.649446851548419`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4`", ",", "4.514268954806539`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "3.2865327542240266`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", "2.129539143792499`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", "1.2064171995261859`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8`", ",", "0.606202956976631`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "0.2846522626459773`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.13109790932867327`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1`", ",", "0.06047556616067595`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2000000000000002`", ",", "0.028053024156179163`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3`", ",", "0.013067922545815236`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4000000000000001`", ",", "0.006102097078837687`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5`", ",", "0.0028520645701064495`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6`", ",", "0.0013339829674805515`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7000000000000002`", ",", "0.0006239788162929472`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1.8`", ",", "0.000291666900011478`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9000000000000001`", ",", "0.0001367315217066789`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2.`", ",", "0.00006371810741256922`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.57391967965247*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Want", " ", "to", " ", "test", " ", "out", " ", "the", " ", "tunneling", 
    " ", "rates"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"W", " ", "=", " ", 
     RowBox[{"WigMaker", "[", 
      RowBox[{"10", ",", ".5", ",", "0", ",", "12", ",", "45"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W0", " ", "=", " ", 
     RowBox[{"W", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W1", " ", "=", " ", 
     RowBox[{"W", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.573919818735503*^9, 3.5739198939273443`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "+", "10000"}]], "Input",
 CellChangeTimes->{{3.573919899087834*^9, 3.5739199000645733`*^9}, {
  3.573919955188607*^9, 3.5739199612843533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "15.905331752295751`"}], ",", 
   RowBox[{"-", "8.56114329488446`"}], ",", 
   RowBox[{"-", "3.0837448046986538`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5739199589562483`*^9, 3.573919961616209*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"WigMaker", "[", 
           RowBox[{"V", ",", ".5", ",", "b", ",", "12", ",", "20"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "6"}], ",", "6", ",", ".1"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"V", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.573919977830031*^9, 3.573920045671712*^9}, {
  3.573920239204938*^9, 3.5739203038146267`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`b$$ = 
    2.4000000000000004`, $CellContext`V$$ = 1.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`V$$], 0, 10}, {
      Hold[$CellContext`b$$], 0, 3}}, Typeset`size$$ = {540., {169., 181.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`V$232475$$ = 0, $CellContext`b$232476$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`b$$ = 0, $CellContext`V$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`V$$, $CellContext`V$232475$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$232476$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Table[{$CellContext`x, 
          Part[
           $CellContext`WigMaker[$CellContext`V$$, 0.5, $CellContext`b$$, 12, 
            20], 1][$CellContext`x]}, {$CellContext`x, -6, 6, 0.1}]], 
      "Specifications" :> {{$CellContext`V$$, 0, 10}, {$CellContext`b$$, 0, 
         3}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{608., {268., 278.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.573920047395117*^9, 3.573920213540613*^9, {3.5739202617923594`*^9, 
   3.573920307917508*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WigMaker", "[", 
     RowBox[{"10", ",", ".5", ",", ".3", ",", "12", ",", "20"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.5739200806183147`*^9, 3.573920128475649*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"groundState1Dplt", "[", 
               RowBox[{"V", ",", ".5", ",", "b", ",", "12", ",", "20"}], 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], "]"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "6"}], ",", "6", ",", ".2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Im", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"groundState1Dplt", "[", 
               RowBox[{"V", ",", ".5", ",", "b", ",", "12", ",", "20"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "]"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "6"}], ",", "6", ",", ".5"}], "}"}]}], "]"}]}], "}"}],
      ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Ground\>\"", ",", "\"\<1E\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"V", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5739203350139*^9, 3.57392033981074*^9}, {
  3.573920593685487*^9, 3.5739206251828127`*^9}, {3.573920656175611*^9, 
  3.573920722440962*^9}, {3.573920884549382*^9, 3.5739209699421577`*^9}, {
  3.573921017247349*^9, 3.573921032323906*^9}, {3.573921082477593*^9, 
  3.57392118879324*^9}, {3.573921226893659*^9, 3.573921285630837*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`b$$ = 1.41, $CellContext`V$$ = 2.35, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`V$$], 0, 10}, {
      Hold[$CellContext`b$$], 0, 3}}, Typeset`size$$ = {658., {162., 172.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`V$255988$$ = 0, $CellContext`b$255989$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`b$$ = 0, $CellContext`V$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`V$$, $CellContext`V$255988$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$255989$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[{
         Table[{$CellContext`x, 
           Re[
            Part[
             $CellContext`groundState1Dplt[$CellContext`V$$, 
              0.5, $CellContext`b$$, 12, 20], 
             1][$CellContext`x]]}, {$CellContext`x, -6, 6, 0.2}], 
         Table[{$CellContext`x, 
           Im[
            Part[
             $CellContext`groundState1Dplt[$CellContext`V$$, 
              0.5, $CellContext`b$$, 12, 20], 
             2][$CellContext`x]]}, {$CellContext`x, -6, 6, 0.5}]}, 
        PlotLegends -> {"Ground", "1E"}], 
      "Specifications" :> {{$CellContext`V$$, 0, 10}, {$CellContext`b$$, 0, 
         3}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{726., {244., 254.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.5739212527990913`*^9, 3.573921288507495*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Im", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"groundState1Dplt", "[", 
           RowBox[{"10", ",", ".5", ",", ".2", ",", "12", ",", "20"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "6"}], ",", "6", ",", ".1"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.57392074629393*^9, 3.573920872967984*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxdlX9M1GUcx49f8lvgOA4Mk4RSttaycQi15Hmcmm6wIGNsbbLYKYHEUEvX
bCCsFaZIAsfR0YQ0bKRxymwaBPQ8Et5wnATdtAhtTNK6FISB/JLT4vm875+e
jbHb8/28n9fneT6f92e1cc/2XE+NRnPwv7+l/7Si5A93jt7Oyi159Yv6pRUp
U5t9VhsMn7AEtSKlcaVrVZ5/DbtmX1p6efjmpqyXw2vZO2rppfekKblZX8VI
Ty+zfjs3/mCmmJFehCwf+Up77EqRIL0IeXa9Je5CR4UgPZ30OTVxPvOaSZCe
TiZkFzY3OkyC9HQyJWa46aX2CkF64TKDTV60zxVCL1wOzE6kbzhUCj6tjP/R
/uvGF6rBp5WZo0MxPXvN4NPKrsR7B9teM4EvTPaYvTbzvHLkGyZzPjOusW1O
AV+onD7UHrdQ9yn4QmVR4ZadKdZa8IXKYb5tqmWuDjwh8m7Ct+ecqTX4frlc
73vE63hhqVDH1QfLgPhYIys4wJS8PUjeutT8pN1YDb4g+VRUd19cmQU8gVI7
ozkenW5BPgFyxaR1X19lFSM9f9n6j8t395YC6PnJuQ0P8/u3Hwafn/z7TL/m
ZOfn4POVR72P2TICG8C3TG51XY/JqKkHn48Mbvnwva3DFYL0vOXAw47hN9/K
BZ+31O7zCNxpMIHPS+6Iej4le1sj+DzlM9l/dNy7/CX4PORPWSGd9dF14NPI
gTFD5bv9+dDTyEqvjX1d5bVil4p/LNqfOB3mdV/j/EWxvzen+0FSizCo8x6J
xsGOxeearMKi9OfFkXnH+2ljZ5DvnNAPWqx7nz0NvRnxnenFri2WU9CbFoH2
iddjB78R65TelFiT0+Oqdn0PvUnxc3zi9V6bDXoT4pU7DQvZ6Q7Rq+Lvi1+e
Nv6pTbqF753Cx34hr2RxVOSo8+6KNF365bUaJ/RHxcWVJ0YOdN+H3ojIdHU2
3SwaF1Uqfkictg34nS8Yw/cOsSf69xVNHzhFmdq/KpLeyG+7aruN3+1ilzku
r2TcITT/W5L2mZn22UmKZ6kUzzjps2LSx/4Qa6Hz8R4jDHwsmfiZlfhZPuXH
OOWHeCeb7VP5swG6H9ZB9wO9CYb7YyfoftlZul9G7znFZt9W94/4aXajT70P
zpthbfR+0JtjeF/ozbOP6f2h94ihPqC3yHZT/UDvMaug+nLXH0f9ueuToz4F
6Xvwv6h+BcV78jiqb9SjF6+l+sd7eHP0h7t/OPoHej681ar6CzzLeCz1H/h9
+SrqT/D5cfSvu785+hv5+3PNpOp/8AXwQvIH8AXyAPIP8AVx+Iug+wniDeQ/
4AvmN9Yqf4Lecl7sr/wLfCE82aD8DXyhHP6HfEL5R+SPrJ/8k7eUKv9EfBgf
MSt/dfsvh/+CT8vhzzhfy8vIvwXpafmlLuXvyC+c719Q/u+eDxzzAXw6jvkB
Ph3ftEPNF/DpuJ7mD/gieGuimk/u+cUxv9zzjWO+gU/P02j+gU/Pr9B8BF8k
D6b5Cb5IjvmKfKM45m/nv/ECfoA=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.},
  Method->{},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.573920760111554*^9, 3.573920787964364*^9}, {
  3.573920818269298*^9, 3.573920876123849*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions:", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.572127540901985*^9, 3.572127543317565*^9}}],

Cell["\[LineSeparator]", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.570215010839119*^9, 3.5702150226415195`*^9}, {
  3.572127572005554*^9, 3.572127573157775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalPsi]", "[", 
   RowBox[{"n_", ",", "x_", ",", "m_", ",", "y_", ",", "L_"}], "]"}], ":=", 
  " ", 
  RowBox[{
   FractionBox["1", "L"], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", "2", 
     FractionBox["\[Pi]", "L"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "*", "x"}], "+", 
       RowBox[{"y", "*", "m"}]}], ")"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5702150251058083`*^9, 3.5702151013501663`*^9}, {
  3.5702151520355673`*^9, 3.5702151802910624`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hp", "[", 
   RowBox[{
   "n_", ",", "x_", ",", "m_", ",", "y_", ",", "L_", ",", "\[CapitalPhi]_", 
    ",", "V_", ",", "c_", ",", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "q", ",", "m", ",", "y", ",", "L"}], "]"}], 
            ",", "q"}], "]"}], ",", "q"}], "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "x", ",", "m", ",", "w", ",", "L"}], "]"}], 
            ",", "w"}], "]"}], ",", "w"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"V", "*", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "b"}], ")"}], "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], 
        SuperscriptBox["c", "2"]], "]"}], 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"n", ",", "x", ",", "m", ",", "y", ",", "L"}], "]"}]}]}], 
    ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", "x"}], ",", 
     RowBox[{"w", "\[Rule]", "y"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570215184883725*^9, 3.570215228654123*^9}, {
  3.5702153656843147`*^9, 3.570215463928651*^9}, {3.570215779092273*^9, 
  3.5702157938471527`*^9}, {3.570218779153079*^9, 3.5702188635205073`*^9}, {
  3.5702269284039097`*^9, 3.5702269306252174`*^9}, {3.5709307596086063`*^9, 
  3.5709307707939215`*^9}, {3.570931186897369*^9, 3.570931197833276*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H2p", "[", 
   RowBox[{
   "n_", ",", "x_", ",", "m_", ",", "y_", ",", "L_", ",", "\[CapitalPhi]_", 
    ",", "V_", ",", "c_", ",", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "q", ",", "m", ",", "y", ",", "L"}], "]"}], 
            ",", "q"}], "]"}], ",", "q"}], "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[CapitalPhi]", "[", 
             RowBox[{"n", ",", "x", ",", "m", ",", "w", ",", "L"}], "]"}], 
            ",", "w"}], "]"}], ",", "w"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"V", "*", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "+", "b"}], ")"}], "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], 
        SuperscriptBox["c", "2"]], "]"}], 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"n", ",", "x", ",", "m", ",", "y", ",", "L"}], "]"}]}], "-", 
     RowBox[{"V", "*", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "b"}], ")"}], "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], 
        SuperscriptBox["c", "2"]], "]"}], 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"n", ",", "x", ",", "m", ",", "y", ",", "L"}], "]"}]}]}], 
    ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", "x"}], ",", 
     RowBox[{"w", "\[Rule]", "y"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5702154106369686`*^9, 3.5702154108509626`*^9}, {
   3.5702154668880014`*^9, 3.570215485975391*^9}, 3.5702155610089054`*^9, {
   3.570218870051346*^9, 3.570218903945597*^9}, {3.5709307108269043`*^9, 
   3.570930774381958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HPlane", "[", 
   RowBox[{"V_", ",", "L_", ",", "n_", ",", "m_", ",", "l_", ",", "q_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"n", ",", "l"}], "]"}], "*", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"m", ",", "q"}], "]"}], "*", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "2"], "+", 
       SuperscriptBox["m", "2"]}], ")"}], "2"]}], "-", " ", 
   RowBox[{"V", "*", 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "*", 
           FractionBox["\[Pi]", "L"]}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "-", "l"}], ")"}], "2"]}], "8"], "]"}], "*", "\[Pi]", 
    "*", 
    FractionBox["1", 
     RowBox[{"2", "*", 
      SuperscriptBox["L", "2"]}]], 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "*", 
           FractionBox["\[Pi]", "L"]}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m", "-", "q"}], ")"}], "2"]}], "8"], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570219192838127*^9, 3.570219197234665*^9}, {
  3.5702192436695185`*^9, 3.5702192900733156`*^9}, {3.570219442121977*^9, 
  3.5702194661109934`*^9}, {3.5702195202318*^9, 3.5702195321232705`*^9}, {
  3.570219576136772*^9, 3.570219634658684*^9}, {3.5702266841284084`*^9, 
  3.5702266845615516`*^9}, {3.5702267770386944`*^9, 3.570226779349032*^9}, {
  3.5702270814494915`*^9, 3.5702270844568915`*^9}, {3.570227414095292*^9, 
  3.570227435630989*^9}, {3.5709312774251366`*^9, 3.5709312862704563`*^9}, {
  3.5709884254526167`*^9, 3.570988425836464*^9}, {3.570988497677177*^9, 
  3.570988498140882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HPlanebtest", "[", 
   RowBox[{
   "V_", ",", "L_", ",", "n_", ",", "m_", ",", "l_", ",", "q_", ",", "b_"}], 
   "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "I", " ", "had", " ", "some", " ", "trouble", " ", "getting", " ", "the", 
     " ", "factors", " ", "in", " ", "EXp", " ", "right"}], ",", " ", 
    RowBox[{"but", " ", "this", " ", "configuration", " ", 
     RowBox[{"worked", ".", " ", "This"}], " ", "is", " ", "for", " ", "one", 
     " ", "well", " ", 
     RowBox[{"only", "!"}], " ", "This", " ", "is", " ", "the", " ", 
     "generalizating", " ", "of", " ", "HPlane"}], ",", " ", 
    RowBox[{"which", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "worry", " ", "about", " ", 
     RowBox[{"b", ".", " ", "This"}], " ", "basically", " ", "lets", " ", 
     "me", " ", "offset", " ", "my", " ", "one", " ", "well", " ", "wherever",
      " ", "I", " ", "want", " ", "to", " ", "double", " ", "check", " ", 
     "that", " ", "I", " ", "have", " ", "the", " ", "right", " ", "form", 
     " ", "of", " ", "the", " ", "analytics"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"n", ",", "l"}], "]"}], "*", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"m", ",", "q"}], "]"}], "*", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n", "2"], "+", 
       SuperscriptBox["m", "2"]}], ")"}], "2"]}], "-", " ", 
   RowBox[{"V", "*", 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "b"}], "+", 
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "L"]}], ")"}], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"n", "-", "l"}], ")"}], "2"]}]}], ")"}], "2"], "-", 
       RowBox[{"4", 
        SuperscriptBox["b", "2"]}]}], "2"], "]"}], "*", "\[Pi]", "*", 
    FractionBox["1", 
     RowBox[{"2", "*", 
      SuperscriptBox["L", "2"]}]], 
    RowBox[{"Exp", "[", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           FractionBox["\[Pi]", "L"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"m", "-", "q"}], ")"}]}], ")"}], "2"], "8"], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57093125165367*^9, 3.5709312898272624`*^9}, {
   3.570931341167391*^9, 3.5709313441782713`*^9}, {3.570932250439*^9, 
   3.5709322589567027`*^9}, {3.5709323074822006`*^9, 3.570932308387007*^9}, 
   3.570932577634177*^9, {3.5709335178890133`*^9, 3.57093352824736*^9}, {
   3.5709883475675707`*^9, 3.570988361948283*^9}, {3.5721278186849003`*^9, 
   3.572127906953497*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H2Plane", "[", 
   RowBox[{
   "V_", ",", "L_", ",", "b_", ",", "n_", ",", "m_", ",", "l_", ",", "q_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"n", ",", "l"}], "]"}], "*", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"m", ",", "q"}], "]"}], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "*", 
        FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "2"], "+", 
        SuperscriptBox["m", "2"]}], ")"}], "2"]}], "-", " ", 
    RowBox[{"V", "*", 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "b"}], "+", 
           RowBox[{"\[ImaginaryI]", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              FractionBox["\[Pi]", "L"]}], ")"}], 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"n", "-", "l"}], ")"}], "2"]}]}], ")"}], "2"], "-", 
        RowBox[{"4", 
         SuperscriptBox["b", "2"]}]}], "2"], "]"}], "*", "\[Pi]", "*", 
     FractionBox["1", 
      RowBox[{"2", "*", 
       SuperscriptBox["L", "2"]}]], 
     RowBox[{"Exp", "[", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "*", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            FractionBox["\[Pi]", "L"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"m", "-", "q"}], ")"}]}], ")"}], "2"], "8"], "]"}]}], "-", 
    RowBox[{"V", "*", 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], "b"}], "+", 
           RowBox[{"\[ImaginaryI]", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              FractionBox["\[Pi]", "L"]}], ")"}], 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"n", "-", "l"}], ")"}], "2"]}]}], ")"}], "2"], "-", 
        RowBox[{"4", 
         SuperscriptBox["b", "2"]}]}], "2"], "]"}], "*", "\[Pi]", "*", 
     FractionBox["1", 
      RowBox[{"2", "*", 
       SuperscriptBox["L", "2"]}]], 
     RowBox[{"Exp", "[", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "*", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            FractionBox["\[Pi]", "L"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"m", "-", "q"}], ")"}]}], ")"}], "2"], "8"], "]"}]}]}], "//",
    "N"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.570680082568841*^9, {3.5706801506789513`*^9, 3.5706802608984394`*^9}, {
   3.5706814558960094`*^9, 3.5706814689845357`*^9}, {3.5709335633165245`*^9, 
   3.5709335716938066`*^9}, {3.5709338675326557`*^9, 3.570933869451476*^9}, {
   3.570988352349019*^9, 3.570988358289434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HMatrix", "[", 
   RowBox[{"V_", ",", "L_", ",", "size_"}], "]"}], ":=", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"HPlane", "[", 
       RowBox[{"V", ",", "L", ",", "m", ",", "l", ",", "n", ",", "q"}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "]"}], "//", "N"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572128069191348*^9, 3.5721280745519753`*^9}, {
  3.5721281434915953`*^9, 3.572128143907481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"groundState", "[", 
   RowBox[{"EM_", ",", "L_", ",", "x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Size", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Length", "[", "EM", "]"}], "]"}]}], ",", " ", "i", ",", 
      "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Given", " ", "an", " ", "eigenvector"}], ",", " ", 
      RowBox[{
      "this", " ", "will", " ", "compute", " ", "a", " ", "plottable", " ", 
       "version", " ", "of", " ", "the", " ", 
       RowBox[{"wavefunction", ".", " ", "However"}]}], ",", " ", 
      RowBox[{"there", " ", "is", " ", "little", " ", "sophistication"}], ",",
       " ", 
      RowBox[{
      "the", " ", "user", " ", "must", " ", "still", " ", "change", " ", 
       "the", " ", "index", " ", "conversion", " ", "number", " ", "by", " ", 
       RowBox[{"hand", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Note", ":", " ", 
         RowBox[{"there", " ", "was", " ", "a", " ", "problem"}], ":", " ", 
         RowBox[{
         "use", " ", "ky", " ", "for", " ", "calculating", " ", "the", " ", 
          "number", " ", "on", " ", "x", " ", "and", " ", "y"}]}]}]}], ",", 
      " ", 
      RowBox[{
      "as", " ", "the", " ", "kx", " ", "function", " ", "gives", " ", "the", 
       " ", "row", " ", "of", " ", "a", " ", "matrix"}], ",", " ", "but", ",",
       " ", 
      RowBox[{"for", " ", "the", " ", "eigenvector"}], ",", " ", 
      RowBox[{"it", " ", "is", " ", "just", " ", 
       RowBox[{"a", " ", "'"}], 
       RowBox[{"column", "'"}], " ", "vector"}], ",", " ", 
      RowBox[{"so", " ", "just", " ", "use", " ", "ky"}]}], "*)"}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Normalize", "[", "EM", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "Size"}], "+", "j"}], "]"}], 
        "]"}], "*", 
       RowBox[{"N", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "2.", "*", 
            FractionBox["\[Pi]", "L"], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ky", "[", 
                RowBox[{"i", ",", "Size"}], "]"}], "*", "x"}], "+", 
              RowBox[{
               RowBox[{"ky", "[", 
                RowBox[{"j", ",", "Size"}], "]"}], "*", "y"}]}], ")"}]}], 
           "]"}], "L"], ",", "8"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "Size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "Size"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572128189351035*^9, 3.572128241737421*^9}, {
  3.5721323143106318`*^9, 3.572132352087255*^9}, {3.572132390263721*^9, 
  3.5721324988055277`*^9}, {3.572132711589464*^9, 3.572132747301024*^9}, {
  3.5721327948084507`*^9, 3.572132818413868*^9}, {3.5721338657642384`*^9, 
  3.572133926723633*^9}, {3.5721879922029543`*^9, 3.572188001611438*^9}, {
  3.5723693482479753`*^9, 3.572369349644309*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GroundStatePlane", "[", 
   RowBox[{"p_", ",", "l_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "HMatrix", ",", "EN", ",", "G", ",", "m", ",", "k", ",", "n", ",", "q"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HMatrix", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"HPlane", "[", 
         RowBox[{"1.5", ",", "10", ",", "m", ",", "l", ",", "n", ",", "q"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EN", " ", "=", " ", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", "HMatrix", "]"}], "-", 
        RowBox[{"100", "*", 
         RowBox[{"IdentityMatrix", "[", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "p"}], "+", "1"}], ")"}], "2"], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"G", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"EN", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "100"}], ",", 
        RowBox[{
         RowBox[{"EN", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GroundStatePlane", "[", 
   RowBox[{"p_", ",", "l_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "HMatrix", ",", "EN", ",", "G", ",", "m", ",", "k", ",", "n", ",", "q"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HMatrix", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"HPlane", "[", 
         RowBox[{"1.5", ",", "10", ",", "m", ",", "l", ",", "n", ",", "q"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", 
          RowBox[{"-", "p"}], ",", "p"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EN", " ", "=", " ", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"HMatrix", "//", "N"}], "]"}], "-", 
        RowBox[{"100", "*", 
         RowBox[{"IdentityMatrix", "[", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "p"}], "+", "1"}], ")"}], "2"], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"G", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"EN", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "100"}], ",", 
        RowBox[{
         RowBox[{"EN", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Harmonic Oscillator Functions:
HMV1[1,2,.1,0,.5]\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.572128489356292*^9, 3.572128494635808*^9}, {
  3.573407653101918*^9, 3.573407667661433*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HMV1", "[", 
  RowBox[{"1", ",", "1", ",", ".1", ",", "0", ",", "0.5"}], "]"}]], "Input",
 CellChangeTimes->{{3.573407672423072*^9, 3.573407727825686*^9}}],

Cell[BoxData["0.01039132810647584`"], "Output",
 CellChangeTimes->{{3.573407696376131*^9, 3.5734077282896643`*^9}, 
   3.5738131660639796`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HMV1", "[", 
  RowBox[{"1", ",", "2", ",", "0.1`", ",", "0.5`"}], "]"}]], "Input",
 CellChangeTimes->{3.573407691626629*^9}],

Cell[BoxData[
 RowBox[{"HMV1", "[", 
  RowBox[{"1", ",", "2", ",", "0.1`", ",", "0.5`"}], "]"}]], "Output",
 CellChangeTimes->{3.573407691906547*^9, 3.5738131660905137`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HMV1", "[", 
   RowBox[{"l_", ",", "m_", ",", "\[Omega]_", ",", "b_", ",", "c_"}], "]"}], ":=",
   " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"Sqrt", "[", "\[Omega]", "]"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"l", "+", "m"}]], 
        RowBox[{"Factorial", "[", "l", "]"}], "*", 
        RowBox[{"Factorial", "[", "m", "]"}]}], "]"}]], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["2", "k"], 
         RowBox[{"Factorial", "[", "k", "]"}], "*", 
         RowBox[{"Binomial", "[", 
          RowBox[{"l", ",", "k"}], "]"}], "*", 
         RowBox[{"Binomial", "[", 
          RowBox[{"m", ",", "k"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "*", 
             FractionBox[
              RowBox[{"\[Omega]", "*", 
               SuperscriptBox["c", "2"]}], 
              RowBox[{"1", "+", 
               RowBox[{"2", 
                SuperscriptBox["c", "2"], "\[Omega]"}]}]]}]}], ")"}], 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"m", "+", "l"}], ")"}], "2"], "-", "k"}]], "*", 
         RowBox[{"HermiteH", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m", "+", "l", "-", 
             RowBox[{"2", "*", "k"}]}], ")"}], ",", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             FractionBox["\[Omega]", 
              RowBox[{"1", "+", 
               RowBox[{"2", "*", 
                SuperscriptBox["c", "2"], "*", "\[Omega]"}]}]], "]"}], "*", 
            "b"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"m", ",", "l"}], "]"}]}], "}"}]}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox["b", "2"], 
        RowBox[{"2", 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"2", 
            SuperscriptBox["c", "2"], "*", "\[Omega]"}]}]], "-", "1"}], 
        ")"}]}], "]"}], "*", 
     RowBox[{"Sqrt", "[", 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{"2", 
         SuperscriptBox["c", "2"], "*", "\[Omega]"}]}]], "]"}], "c"}], ")"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.573407687335093*^9, 3.573407718292557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hx2Anal2", "[", 
   RowBox[{"l_", ",", "m_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "l"}], "+", "1"}], ")"}], "*", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "+", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"l", "+", "2"}], ")"}]}], "]"}], 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{
      RowBox[{"l", "+", "1"}], ",", 
      RowBox[{"m", "-", "1"}]}], "]"}]}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"m", "+", "2"}], ")"}]}], "]"}], 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{
      RowBox[{"l", "-", "1"}], ",", 
      RowBox[{"m", "+", "1"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"HOBasis", "[", 
   RowBox[{"V_", ",", "b_", ",", "c_", ",", "size_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Sqrt", "[", 
       FractionBox[
        RowBox[{"2", "V"}], 
        SuperscriptBox["c", "2"]], "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["\[Omega]", "2"], "*", 
        RowBox[{"Hx2Anal2", "[", 
         RowBox[{"n", ",", "m"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["\[Omega]", "2"], "*", 
        RowBox[{"Hx2Anal2", "[", 
         RowBox[{"l", ",", "q"}], "]"}]}], "-", 
       RowBox[{"V", "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"n", ",", "m", ",", "\[Omega]", ",", "b", ",", "c"}], "]"}], 
        "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"l", ",", "q", ",", "\[Omega]", ",", "0", ",", "c"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570885920269978*^9, 3.5708859340123653`*^9}, {
   3.570885984099249*^9, 3.570886075990157*^9}, {3.570886223990593*^9, 
   3.5708862621362886`*^9}, {3.570895371759161*^9, 3.570895424848665*^9}, {
   3.57089810518782*^9, 3.570898171012825*^9}, {3.5709835339686947`*^9, 
   3.5709835367828827`*^9}, 3.5709835802714243`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HOBasis1Well", "[", 
   RowBox[{"V_", ",", "c_", ",", "size_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "*", 
        FractionBox["V", 
         SuperscriptBox["c", "2"]]}], "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["\[Omega]", "2"], "*", 
        RowBox[{"Hx2Anal2", "[", 
         RowBox[{"n", ",", "m"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"l", ",", "q"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["\[Omega]", "2"], "*", 
        RowBox[{"Hx2Anal2", "[", 
         RowBox[{"l", ",", "q"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}], "-", 
       RowBox[{"V", "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"n", ",", "m", ",", "\[Omega]", ",", "0", ",", "c"}], "]"}], 
        "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"l", ",", "q", ",", "\[Omega]", ",", "0", ",", "c"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", 
        RowBox[{"size", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570898267668626*^9, 3.5708982805480013`*^9}, {
  3.570898960568728*^9, 3.570898981594881*^9}, {3.5708990116585703`*^9, 
  3.570899011963595*^9}, {3.5708990660276012`*^9, 3.570899066203285*^9}, {
  3.570983297935081*^9, 3.5709833033580017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotGround", "[", 
   RowBox[{
   "\[CapitalPsi]_", ",", "H_", ",", "V_", ",", "c_", ",", "b_", ",", "size_",
     ","}], "]"}], ":=", " ", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "k", ",", "Em", ",", "M", ",", "HOBasis"}], "}"}], ",",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalPsi]", "[", 
                RowBox[{"n", ",", "x", ",", "V", ",", "c"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Normalize", "[", 
                 RowBox[{
                  RowBox[{"Em", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"n", ",", "0", ",", "size"}], "}"}]}], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "V"}], 
           RowBox[{"c", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", "\[Pi]"}], "]"}]}]], 
          RowBox[{"Exp", "[", 
           FractionBox[
            RowBox[{"-", 
             SuperscriptBox["x", "2"]}], 
            RowBox[{"4.", "*", "V", "*", 
             SuperscriptBox["c", "2"]}]], "]"}]}], "//", "N"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57089525831597*^9, 3.570895279711782*^9}, {
  3.570897367385829*^9, 3.570897529953704*^9}, {3.572367062116728*^9, 
  3.572367076496973*^9}, {3.572367132873954*^9, 3.572367134357418*^9}}],

Cell[CellGroupData[{

Cell[BoxData["plotGround"], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570895283855715*^9, 3.57089528638737*^9}}],

Cell[BoxData["plotGround"], "Output",
 CellChangeTimes->{
  3.572131566533577*^9, {3.57219536311866*^9, 3.572195382524304*^9}, 
   3.5738126588918796`*^9, {3.5738131654606256`*^9, 3.573813166160533*^9}, 
   3.5739013352798123`*^9, 3.573918065505396*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotGround2wellHO2d", "[", 
   RowBox[{"\[CapitalPsi]_", ",", "V_", ",", "b_", ",", "c_", ",", "size_"}], 
   "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "*", 
         FractionBox["V", 
          RowBox[{
           RowBox[{"6", "b", "*", "c"}], "+", 
           RowBox[{"9", 
            SuperscriptBox["c", "2"]}]}]]}], "]"}]}], ",", "HOBasis", ",", 
      "Em"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"HOBasis", "[", 
       RowBox[{"V", ",", "b", ",", "c", ",", "size", ",", "\[Omega]"}], "]"}],
       ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["\[Omega]", "2"], "*", 
            RowBox[{"Hx2Anal2", "[", 
             RowBox[{"n", ",", "m"}], "]"}]}], "+", 
           RowBox[{
            FractionBox["\[Omega]", "2"], "*", 
            RowBox[{"Hx2Anal2", "[", 
             RowBox[{"l", ",", "q"}], "]"}]}], "-", 
           RowBox[{"V", "*", 
            RowBox[{"HMV1", "[", 
             RowBox[{"n", ",", "m", ",", "\[Omega]", ",", 
              RowBox[{"-", "b"}], ",", "c"}], "]"}], "*", 
            RowBox[{"HMV1", "[", 
             RowBox[{"l", ",", "q", ",", "\[Omega]", ",", "b", ",", "c"}], 
             "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "0", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "0", ",", "size"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Em", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eigensystem", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{
          RowBox[{"HOBasis", "[", 
           RowBox[{
            SuperscriptBox["1.5", "2"], ",", "1", ",", ".5", ",", "7", ",", 
            "\[Omega]"}], "]"}], "-", 
          RowBox[{"1000", "*", 
           RowBox[{"IdentityMatrix", "[", "42", "]"}]}]}], "]"}], "]"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"{", 
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalPsi]", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "x", ",", "V", ",", "c", ",", 
                 "\[Omega]"}], "]"}], "*", 
               RowBox[{"\[CapitalPsi]", "[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", "x", ",", "V", ",", "c", ",", 
                 "\[Omega]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Normalize", "[", 
                 RowBox[{
                  RowBox[{"Em", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", 
                   RowBox[{"(", "size", ")"}]}], "+", "j"}], "]"}], "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "17"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "17"}], "}"}]}], "]"}], "]"}], 
           "2"], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57089533059254*^9, 3.570895347632304*^9}, {
   3.570895446145853*^9, 3.570895467825232*^9}, {3.570895522605443*^9, 
   3.570895560099419*^9}, {3.57089559772987*^9, 3.570895653763194*^9}, 
   3.570895741827547*^9, {3.570895806483992*^9, 3.570895821797204*^9}, {
   3.570895897602663*^9, 3.570895939687346*^9}, {3.5708960985682507`*^9, 
   3.570896117688366*^9}, {3.570896269414405*^9, 3.570896280191505*^9}, {
   3.570896341423107*^9, 3.5708964735857277`*^9}, {3.570896543131679*^9, 
   3.5708965723200207`*^9}, {3.570896614956777*^9, 3.570896645902726*^9}, {
   3.5708967228948307`*^9, 3.570896745810275*^9}, {3.570896796370328*^9, 
   3.570896798411419*^9}, {3.5708968441754827`*^9, 3.57089694268522*^9}, {
   3.57089699795343*^9, 3.5708970388476458`*^9}, 3.570897361581813*^9, {
   3.570897531315144*^9, 3.570897552919519*^9}, {3.570897584404173*^9, 
   3.570897648554591*^9}, {3.5734064731875877`*^9, 3.5734064779188223`*^9}, {
   3.573406542217595*^9, 3.573406566120376*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotGround2wellHO2dT", "[", 
   RowBox[{
   "\[CapitalPsi]_", ",", "V_", ",", "b_", ",", "c_", ",", "size_", ",", 
    "Em_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "*", 
         FractionBox["V", 
          SuperscriptBox["c", "2"]]}], "]"}]}], ",", "x", ",", "y"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "x", ",", "V", ",", "c", ",", 
          "\[Omega]"}], "]"}], "*", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", "y", ",", "V", ",", "c", ",", 
          "\[Omega]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Normalize", "[", 
          RowBox[{
           RowBox[{"Em", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", 
            RowBox[{"(", "size", ")"}]}], "+", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{"{", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalPsi]", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "x", ",", "V", ",", "c", ",", 
               "\[Omega]"}], "]"}], "*", 
             RowBox[{"\[CapitalPsi]", "[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", "y", ",", "V", ",", "c", ",", 
               "\[Omega]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{
                RowBox[{"Em", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "*", 
                 RowBox[{"(", "size", ")"}]}], "+", "j"}], "]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}], 
         "2"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708977492067337`*^9, 3.570897780689465*^9}, {
  3.5708978643700943`*^9, 3.570897879854721*^9}, {3.5708979105684958`*^9, 
  3.570897916455763*^9}, {3.570898041434421*^9, 3.570898046376409*^9}, {
  3.570988847464078*^9, 3.5709888590488987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HM2Well", "[", 
   RowBox[{"V_", ",", "b_", ",", "c_", ",", "size_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "*", 
        FractionBox["V", 
         RowBox[{
          RowBox[{"6", "*", "b", "*", "c"}], "+", 
          RowBox[{"9", 
           SuperscriptBox["c", "2"]}]}]]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["\[Omega]", "2"], "*", 
        RowBox[{"Hx2Anal2", "[", 
         RowBox[{"n", ",", "m"}], "]"}]}], "-", 
       RowBox[{"V", "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"n", ",", "m", ",", "\[Omega]", ",", "b", ",", "c"}], 
         "]"}]}], "-", 
       RowBox[{"V", "*", 
        RowBox[{"HMV1", "[", 
         RowBox[{"n", ",", "m", ",", "\[Omega]", ",", 
          RowBox[{"-", "b"}], ",", "c"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "size"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EnGround2wellHO", "[", 
   RowBox[{"V_", ",", "b_", ",", "c_", ",", "size_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"EnGround2wellHO", "[", 
    RowBox[{"V", ",", "b", ",", "c", ",", "size"}], "]"}], "=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Em", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"M", "=", 
        RowBox[{
         RowBox[{"HM2Well", "[", 
          RowBox[{"V", ",", "b", ",", "c", ",", "size"}], "]"}], "-", 
         RowBox[{"1000", "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"size", "+", "1"}], "]"}]}]}]}], ")"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"Em", "=", 
        RowBox[{"Eigenvalues", "[", "M", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.573406922906785*^9, 3.573406929084024*^9}, {
  3.573406970688098*^9, 3.5734070010456753`*^9}, {3.573407201441255*^9, 
  3.573407202800108*^9}, {3.5734080558973*^9, 3.5734080794661493`*^9}}],

Cell[CellGroupData[{

Cell["Sparse Matrices Stuff:", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5721285859014063`*^9, 3.572128594332904*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"deltaK_", ",", "L_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"R", "[", "deltaK", "]"}], "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "*", 
           FractionBox["\[Pi]", "L"]}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", "deltaK", ")"}], "2"]}], "8."], "]"}], "//", 
    "N"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571000978783464*^9, 3.571000995356388*^9}, {
   3.57100108162978*^9, 3.571001117827796*^9}, {3.571001225972803*^9, 
   3.571001269343255*^9}, {3.571001381201169*^9, 3.571001395328429*^9}, 
   3.571004628985114*^9, {3.571007252187564*^9, 3.5710072677402973`*^9}}],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571004666397975*^9, 3.571004700102571*^9}, {
  3.57100473234347*^9, 3.571004781941791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"yIndex", "[", 
   RowBox[{"i_", ",", "size_"}], "]"}], " ", "=", 
  RowBox[{"Mod", "[", 
   RowBox[{"i", ",", "size", ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571004907370202*^9, 3.571004924473065*^9}, {
  3.5710054483336563`*^9, 3.5710054492613583`*^9}, {3.571005547198454*^9, 
  3.571005548798235*^9}, {3.571005578974455*^9, 3.571005581518189*^9}, {
  3.571005916080695*^9, 3.571005917216366*^9}, {3.571006207794964*^9, 
  3.571006207937745*^9}, {3.571006840166703*^9, 3.57100684024616*^9}, {
  3.571076210663637*^9, 3.571076210823251*^9}}],

Cell[BoxData[
 RowBox[{"Mod", "[", 
  RowBox[{"i", ",", "size", ",", "1"}], "]"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.5710762115073767`*^9, 3.5721253050147667`*^9, 3.57213035834122*^9, 
   3.5721315666206703`*^9, {3.5721953632791653`*^9, 3.57219538266177*^9}, 
   3.573812658960898*^9, {3.5738131655226808`*^9, 3.5738131662340345`*^9}, 
   3.5739013353778615`*^9, 3.573918065693384*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571076026372032*^9, 3.57107602933237*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "y", " ", "index", " ", "will", " ", "take", " ", "a", " ", "number", " ",
      "from", " ", "1"}], "-", "n"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "and", " ", "convert", " ", "it", " ", "into", " ", "a", " ", "quantum",
        " ", "number", " ", "for", " ", 
       RowBox[{"ky", ".", " ", "This"}], " ", "will", " ", "be", " ", "an", 
       " ", "integer", " ", "starting", " ", "from"}], " ", "-", "p"}], 
     ".."}], 
    RowBox[{"p", "."}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57107603194378*^9, 3.571076091161105*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"yIndex", "[", 
  RowBox[{"2", ",", "4"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571005038934815*^9, 3.5710050672733603`*^9}, {
  3.571005382620392*^9, 3.571005387291419*^9}, {3.5710054932604113`*^9, 
  3.571005504204275*^9}, {3.571005555084961*^9, 3.571005607580825*^9}, {
  3.57100564708575*^9, 3.571005649037367*^9}, {3.571005791198532*^9, 
  3.571005816590447*^9}, {3.5710060719045067`*^9, 3.571006073328672*^9}, {
  3.571006203681294*^9, 3.5710062607534933`*^9}, {3.571076215942932*^9, 
  3.5710762331426697`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.5721315666774054`*^9, {3.5721953633743763`*^9, 3.5721953827609253`*^9}, 
   3.573812658993907*^9, {3.57381316556565*^9, 3.5738131662720437`*^9}, 
   3.5739013354288664`*^9, 3.573918066771693*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ky", "[", 
   RowBox[{"i_", ",", "size_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"yIndex", "[", 
    RowBox[{"i", ",", "size"}], "]"}], "-", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"size", "-", "1"}], ")"}], "2"], "-", "1"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5710763687580748`*^9, 3.5710763940246277`*^9}, {
  3.5710765462181892`*^9, 3.571076615531767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  FractionBox[
   RowBox[{"1", "-", "size"}], "2"], "+", 
  RowBox[{"Mod", "[", 
   RowBox[{"i", ",", "size", ",", "1"}], "]"}]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.572130355085424*^9, 3.57213156672609*^9, {3.572195363481542*^9, 
   3.572195382827812*^9}, {3.573813165592656*^9, 3.57381316629757*^9}, 
   3.5739013354628696`*^9, 3.573918067264682*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "this", " ", "will", " ", "convert", " ", "our", " ", "index", " ", 
   "number", " ", "to", " ", "a", " ", "range", " ", "that", " ", "runs", " ",
    "over", " ", "negative", " ", "numbers", " ", "so", " ", "we", " ", "can",
    " ", "get", " ", "backwards", " ", "waves"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5721268972365522`*^9, 3.572126923589943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"kx", "[", 
   RowBox[{"i_", ",", "size_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"xIndex", "[", 
    RowBox[{"i", ",", "size"}], "]"}], "-", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"size", "-", "1"}], ")"}], "2"], "-", "1"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571076590427719*^9, 3.571076619339654*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"1", "-", "size"}], "2"], "+", 
  FractionBox[
   RowBox[{"i", "-", 
    RowBox[{"Mod", "[", 
     RowBox[{"i", ",", "size", ",", "1"}], "]"}]}], "size"]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5710765950937767`*^9, 3.5710766201886*^9}, 
   3.5721252970286217`*^9, 3.572130353784877*^9, 3.5721315667749777`*^9, {
   3.57219536382935*^9, 3.572195382936722*^9}, 3.5738126590319166`*^9, {
   3.5738131656266804`*^9, 3.5738131663330665`*^9}, 3.573901335512876*^9, 
   3.573918067547678*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kx", "[", 
  RowBox[{"6", ",", "5"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571076600371318*^9, 3.571076677513527*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.5710766086620207`*^9, 3.5710766778473263`*^9}, 
   3.572130351320689*^9, 3.572131566815014*^9, {3.5721953638982*^9, 
   3.572195383002089*^9}, 3.573812659056405*^9, {3.573813165653698*^9, 
   3.5738131663600645`*^9}, 3.57390133554788*^9, 3.5739180680913363`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"xIndex", "[", 
   RowBox[{"i_", ",", "size_"}], "]"}], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"(", 
     RowBox[{"i", "-", 
      RowBox[{"Mod", "[", 
       RowBox[{"i", ",", "size", ",", "1"}], "]"}]}], ")"}], "size"], "+", 
   "1"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571004930287951*^9, 3.5710049523452063`*^9}, {
  3.571005317372704*^9, 3.571005318764783*^9}, {3.5710057394878883`*^9, 
  3.571005751535363*^9}, {3.571005930832862*^9, 3.571005931200572*^9}, {
  3.5710060235052032`*^9, 3.5710060497785254`*^9}, {3.571006165012313*^9, 
  3.5710061653792467`*^9}, {3.571006835208407*^9, 3.571006835303487*^9}, {
  3.571076261305995*^9, 3.571076261433284*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"i", "-", 
    RowBox[{"Mod", "[", 
     RowBox[{"i", ",", "size", ",", "1"}], "]"}]}], "size"]}]], "Output",
 InitializationCell->True,
 CellChangeTimes->{
  3.571004952693384*^9, 3.5710053193684464`*^9, 3.571005466457485*^9, 
   3.5710057520114*^9, 3.571006050237624*^9, 3.5710061663504143`*^9, 
   3.571006836195053*^9, 3.571073692860424*^9, 3.571076262340887*^9, 
   3.57212529925669*^9, 3.572130349645472*^9, 3.57213156685341*^9, {
   3.5721953639946547`*^9, 3.5721953830777283`*^9}, 3.573812659098934*^9, {
   3.5738131656812134`*^9, 3.5738131663855915`*^9}, 3.5739013355878854`*^9, 
   3.5739180721803427`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BuildPlaneMatrix", "[", 
    RowBox[{"V_", ",", "L_", ",", "p_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MDense", ",", "MDiag", ",", "i", ",", "j", ",", "M"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MDense", " ", "=", " ", 
       RowBox[{
        RowBox[{"-", "V"}], "*", "\[Pi]", "*", 
        FractionBox["1", 
         RowBox[{"2", "*", 
          SuperscriptBox["L", "2"]}]], "*", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"kx", "[", 
                RowBox[{"j", ",", "p"}], "]"}], "-", 
               RowBox[{"kx", "[", 
                RowBox[{"i", ",", "p"}], "]"}]}], ",", "L"}], "]"}], "*", 
            RowBox[{"R", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ky", "[", 
                RowBox[{"j", ",", "p"}], "]"}], "-", 
               RowBox[{"ky", "[", 
                RowBox[{"i", ",", "p"}], "]"}]}], ",", "L"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["p", "2"], ",", 
            SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MDiag", " ", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"2", "*", 
              FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"kx", "[", 
                 RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"ky", "[", 
                 RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"]}], ")"}], 
            "2"]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["p", "2"], ",", 
           SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"MDense", "+", "MDiag"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/eTcycPqs185KhzsPg2i133KuAqiw7hF74Poy1nn
v4Fol4UHf4Hok/OmGmkA6SKNFWC6ZIrsbRD96fD1xyCaz/L5SxDNYdn+BkSv
qF39EURv0tj3E0R3bU8X0ATSfa+mgWnRuU/kQfQbIUUNEJ0/X1kfRH8xswHT
bF/djEF0Q2eRGYi2OPE4FkR7lrwF03wnTnp4Aukfl+M9QfQiq12nQTST5dQr
IHqOy40FnnNfOZ5yYV4EolW0drwA0deOy78E0aLa5Z9BdNW0LWDa4MsZGx8g
7a14DUwvXrTvKYi+5lrwDEQDAJ4CnhI=
  "]],

Cell[BoxData[
 RowBox[{"Clear", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.572131647363564*^9, 3.5721316570292053`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildPlaneMatrix2D2Well", "[", 
   RowBox[{"V_", ",", "L_", ",", "p_", ",", "b_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MDense", ",", "MDiag", ",", "i", ",", "j", ",", "M"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "I", " ", "am", " ", "choosing", " ", "the", " ", "wells", " ", "to", 
        " ", "be", " ", "on", " ", "the", " ", "x"}], "-", "axis"}], ",", " ", 
      RowBox[{
       RowBox[{"so", " ", "the", " ", "y"}], "-", 
       RowBox[{"axis", " ", "dynamics", " ", 
        RowBox[{"shouldn", "'"}], "t", "\[IndentingNewLine]", 
        RowBox[{"change", ".", " ", "Notice"}]}]}], ",", " ", 
      RowBox[{
      "the", " ", "R2W", " ", "contains", " ", "b", " ", "information"}], ",",
       " ", 
      RowBox[{
      "and", " ", "will", " ", "be", " ", "used", " ", "for", " ", "the", " ", 
       RowBox[{"kx", "'"}], "s"}], ",", " ", 
      RowBox[{"while", " ", "the", " ", "R", " ", 
       RowBox[{"doesn", "'"}], "t"}], ",", " ", 
      RowBox[{
      "and", " ", "can", " ", "be", " ", "used", " ", "for", " ", "the", " ", 
       RowBox[{"ky", "'"}], "s", " ", "without", " ", "loss", " ", "of", " ", 
       "generality"}], ",", " ", 
      RowBox[{"because", " ", "there", " ", "are", " ", "two", " ", "wells"}],
       ",", " ", 
      RowBox[{
      "there", " ", "is", " ", "another", " ", "term", " ", "in", " ", "our", 
       " ", "MDense"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MDense", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "V"}], "*", "\[Pi]", "*", 
       FractionBox["1", 
        RowBox[{"2", "*", 
         SuperscriptBox["L", "2"]}]], "*", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"R2W", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"kx", "[", 
                 RowBox[{"j", ",", "p"}], "]"}], "-", 
                RowBox[{"kx", "[", 
                 RowBox[{"i", ",", "p"}], "]"}]}], ",", "L", ",", "b"}], 
              "]"}], "+", 
             RowBox[{"R2W", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"kx", "[", 
                 RowBox[{"j", ",", "p"}], "]"}], "-", 
                RowBox[{"kx", "[", 
                 RowBox[{"i", ",", "p"}], "]"}]}], ",", "L", ",", 
               RowBox[{"-", "b"}]}], "]"}]}], ")"}], "*", 
           RowBox[{"R", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ky", "[", 
               RowBox[{"j", ",", "p"}], "]"}], "-", 
              RowBox[{"ky", "[", 
               RowBox[{"i", ",", "p"}], "]"}]}], ",", "L"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["p", "2"], ",", 
           SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MDiag", " ", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"kx", "[", 
                RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"ky", "[", 
                RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"]}], ")"}], 
           "2"]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["p", "2"], ",", 
          SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"MDense", "+", "MDiag"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5721267052277822`*^9, 3.572126705773741*^9}, {
  3.572127033781926*^9, 3.5721272320948067`*^9}, {3.572129464968992*^9, 
  3.5721294673137836`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R2W", "[", 
   RowBox[{"deltaK_", ",", "L_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"R2W", "[", 
    RowBox[{"deltaK", ",", "L", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2.", "*", "b"}], "+", 
          RowBox[{"\[ImaginaryI]", 
           RowBox[{"(", 
            RowBox[{"2.", "*", 
             FractionBox["\[Pi]", "L"]}], ")"}], 
           FractionBox[
            RowBox[{"(", "deltaK", ")"}], "2"]}]}], ")"}], "2"], "-", 
       RowBox[{"4.", "*", 
        SuperscriptBox["b", "2"]}]}], "2."], "]"}], "//", "N"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5721268078315277`*^9, 3.5721268599771137`*^9}, {
  3.5721269456740294`*^9, 3.572126964026145*^9}, {3.5721296396950617`*^9, 
  3.572129651772911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Tunneling", " ", "for", " ", "a", " ", "2", "D", " ", "2", "Well", " ", 
    "case"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tunneling2DWellListGen", "[", "basisnum_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Need", " ", "to", " ", "double", " ", "check", " ", "that", " ", "L"}], 
     "=", 
     RowBox[{
     "1", " ", "is", " ", "okay", " ", "for", " ", "small", " ", "b"}]}], 
    "*)"}], 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EnergyList", ",", "TunnelingList"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EnergyList", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{
            RowBox[{"Eigenvalues", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BuildPlaneMatrix2D2Well", "[", 
                RowBox[{"10", ",", "8", ",", "basisnum", ",", 
                 RowBox[{"b", "/", "2."}]}], "]"}], "-", 
               RowBox[{"1000.", "*", 
                RowBox[{"IdentityMatrix", "[", 
                 SuperscriptBox["basisnum", "2"], "]"}]}]}], ",", "2"}], 
             "]"}], "+", "1000"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", ".1", ",", "4", ",", ".2"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TunnelingList", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"EnergyList", "[", 
             RowBox[{"[", "p", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EnergyList", "[", 
               RowBox[{"[", "p", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"EnergyList", "[", 
               RowBox[{"[", "p", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", 
           RowBox[{"Length", "[", "EnergyList", "]"}]}], "}"}]}], "]"}]}]}]}],
     "\n", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.572898683635507*^9, 3.5728988670804653`*^9}, {
   3.572898901199182*^9, 3.572898908059278*^9}, {3.572898958257339*^9, 
   3.572899076096239*^9}, {3.572899111755712*^9, 3.572899116962686*^9}, {
   3.5728991821113167`*^9, 3.5728991835178823`*^9}, {3.572899285183936*^9, 
   3.5728992989466867`*^9}, {3.572899424272739*^9, 3.5728994247352858`*^9}, {
   3.572899523970052*^9, 3.57289954929869*^9}, {3.572899660527895*^9, 
   3.5728996867980127`*^9}, {3.57289972612869*^9, 3.572899729216799*^9}, {
   3.5728997782653093`*^9, 3.572899778496242*^9}, {3.572899830738913*^9, 
   3.572899830980447*^9}, {3.572899887016218*^9, 3.572899911705093*^9}, {
   3.572899942805539*^9, 3.572899943366991*^9}, {3.572899987685001*^9, 
   3.57290000312385*^9}, {3.572900132235516*^9, 3.572900139162187*^9}, {
   3.572901797175879*^9, 3.5729017980865717`*^9}, 3.572902212202299*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"10", "/", "25."}]], "Input",
 CellChangeTimes->{{3.5729021970625763`*^9, 3.572902198714232*^9}}],

Cell[BoxData["0.4`"], "Output",
 CellChangeTimes->{3.572902199044324*^9, 3.5738131664496098`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "1", "D", " ", "Functions", " ", "for", " ", "plane", " ", "waves"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5723789053583527`*^9, 3.572378913475903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computePlaneMatrix2Well", "[", 
   RowBox[{"V_", ",", "c_", ",", "b_", ",", "length_", ",", "p_"}], "]"}], ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "m", ",", "H", ",", "Em", ",", "M", ",", "norm"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "First", " ", "normalize", " ", "the", " ", "plane", " ", "wave", " ", 
      "on", " ", "the", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["m", "2"], "2"], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"m", ",", "l"}], "]"}]}], " ", "-", " ", 
       RowBox[{"V", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"2", 
             SuperscriptBox["c", "2"]}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "b"}], "+", 
              RowBox[{"\[ImaginaryI]", "*", 
               SuperscriptBox["c", "2"], 
               RowBox[{"(", 
                RowBox[{"l", "-", "m"}], ")"}]}]}], ")"}], "2"]}], "-", 
          FractionBox[
           SuperscriptBox["b", "2"], 
           RowBox[{"2", 
            SuperscriptBox["c", "2"]}]]}], "]"}], "*", 
        RowBox[{"Sqrt", "[", "\[Pi]", "]"}], "*", 
        FractionBox[
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "c"}], "length"]}], "-", 
       RowBox[{"V", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{"2", 
              SuperscriptBox["c", "2"]}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"b", "+", 
               RowBox[{"\[ImaginaryI]", "*", 
                SuperscriptBox["c", "2"], 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}]}]}], ")"}], "2"]}], "-", 
           FractionBox[
            SuperscriptBox["b", "2"], 
            RowBox[{"2", 
             SuperscriptBox["c", "2"]}]]}], ")"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", "\[Pi]", "]"}], "*", 
        FractionBox[
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "c"}], "length"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"H", "[", 
            RowBox[{
             RowBox[{"2", "\[Pi]", "*", 
              FractionBox["l", "length"]}], ",", 
             RowBox[{"2", "\[Pi]", "*", 
              FractionBox["m", "length"]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", 
             RowBox[{
              RowBox[{"-", "p"}], "/", "2."}], ",", 
             RowBox[{"p", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"-", "p"}], "/", "2."}], ",", 
             RowBox[{"p", "/", "2."}]}], "}"}]}], "]"}], "-", 
         RowBox[{"10000", "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"p", "+", "1"}], "]"}]}]}], ",", "3"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputePlaneWave", "[", 
   RowBox[{"V_", ",", "L_", ",", "p_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "MDense", ",", "MDiag", ",", "i", ",", "j", ",", "M", ",", "EM"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MDense", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "V"}], "*", "\[Pi]", "*", 
       FractionBox["1", 
        RowBox[{"2", "*", 
         SuperscriptBox["L", "2"]}]], "*", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"kx", "[", 
               RowBox[{"j", ",", "p"}], "]"}], "-", 
              RowBox[{"kx", "[", 
               RowBox[{"i", ",", "p"}], "]"}]}], ",", "L"}], "]"}], "*", 
           RowBox[{"R", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ky", "[", 
               RowBox[{"j", ",", "p"}], "]"}], "-", 
              RowBox[{"ky", "[", 
               RowBox[{"i", ",", "p"}], "]"}]}], ",", "L"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["p", "2"], ",", 
           SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MDiag", " ", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", "*", 
             FractionBox["\[Pi]", "L"]}], ")"}], "2"], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"kx", "[", 
                RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"ky", "[", 
                RowBox[{"i", ",", "p"}], "]"}], ")"}], "2"]}], ")"}], 
           "2"]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["p", "2"], ",", 
          SuperscriptBox["p", "2"]}], "}"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{"MDense", "+", "MDiag"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"EM", " ", "=", " ", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"M", "-", 
         RowBox[{"10000", "*", 
          RowBox[{"IdentityMatrix", "[", 
           SuperscriptBox["p", "2"], "]"}]}]}], ",", "3"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.573404541555847*^9, 3.5734045459797707`*^9}, {
  3.573404580765032*^9, 3.5734046331788597`*^9}, {3.573404814204865*^9, 
  3.573404814542769*^9}, {3.573404896059642*^9, 3.573404922409494*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ky", "[", 
  RowBox[{"5", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.5738141822258263`*^9, 3.573814189764825*^9}, {
  3.5738142682369037`*^9, 3.573814270812793*^9}, {3.5738143139620776`*^9, 
  3.57381432724021*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.573814190174921*^9, 3.5738142713483696`*^9, {3.5738143146234784`*^9, 
   3.5738143276386795`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"groundState1D", "[", 
   RowBox[{"EM_", ",", "L_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Size", " ", "=", 
       RowBox[{"Length", "[", "EM", "]"}]}], ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EMn", " ", "=", " ", 
      RowBox[{"Normalize", "[", "EM", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EMn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"N", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", "2.", "*", 
             FractionBox["\[Pi]", "L"], "*", 
             RowBox[{"ky", "[", 
              RowBox[{"i", ",", "Size"}], "]"}], "*", "x"}], "]"}], 
           RowBox[{"Sqrt", "[", "L", "]"}]], ",", "8"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Size"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.573404617802964*^9, 3.5734046283493023`*^9}, {
  3.573813990839531*^9, 3.573814170308418*^9}, {3.573814334963518*^9, 
  3.5738143731236496`*^9}, {3.573814476837121*^9, 3.5738144855907907`*^9}, {
  3.5738145389284325`*^9, 3.573814554191955*^9}, {3.5739014195309362`*^9, 
  3.5739014216582007`*^9}, {3.5739020356532536`*^9, 3.5739020402568293`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "EMn", "]"}]], "Input",
 CellChangeTimes->{{3.57381451515488*^9, 3.5738145177520294`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"groundState1Dplt", "[", 
    RowBox[{"V_", ",", "c_", ",", "b_", ",", "L_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"WE", ",", "x", ",", "gstate", ",", "estate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WE", " ", "=", " ", 
       RowBox[{"computePlaneMatrix2Well", "[", 
        RowBox[{"V", ",", "c", ",", "b", ",", "L", ",", "p"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gstate", "[", "x_", "]"}], ":=", 
       RowBox[{"groundState1D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"WE", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "L", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"estate", "[", "x_", "]"}], ":=", 
       RowBox[{"groundState1D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"WE", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "L", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"gstate", ",", "estate"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5739203661901503`*^9, 3.5739205085723467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WigMaker", "[", 
   RowBox[{"V_", ",", "c_", ",", "b_", ",", "L_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "WE", ",", "WigPsi0", ",", "WigPsi1", ",", "Wig1", ",", "Wig2", ",", 
      "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WE", " ", "=", " ", 
      RowBox[{"computePlaneMatrix2Well", "[", 
       RowBox[{"V", ",", "c", ",", "b", ",", "L", ",", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"WE", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "10000"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"groundState1D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WE", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "12", ",", "x"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", ",", " ", 
       RowBox[{"take", " ", "the", " ", "eigenvectors"}], ",", " ", 
       RowBox[{
       "and", " ", "build", " ", "the", " ", "wannier", " ", "functions"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WigPsi0", " ", "[", "x_", "]"}], " ", "=", " ", 
      RowBox[{"groundState1D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WE", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "L", ",", "x"}], "]"}]}], ";", 
     "\n", 
     RowBox[{
      RowBox[{"WigPsi1", "[", "x_", "]"}], " ", "=", " ", 
      RowBox[{"groundState1D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WE", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "L", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Check", " ", "normalization", " ", "of", " ", "the", " ", "ground", 
       " ", "and", " ", "excite", " ", "state"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Wig1", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Wig1", "[", "x", "]"}], "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "+", 
          RowBox[{"Im", "[", 
           RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
        RowBox[{"Sqrt", "[", "2", "]"}]]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Wig2", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Wig2", "[", "x", "]"}], "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "-", 
          RowBox[{"Im", "[", 
           RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
        RowBox[{"Sqrt", "[", "2", "]"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Wig1", ",", "Wig2", ",", 
       RowBox[{"WE", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.573904849000251*^9, 3.5739049308964987`*^9}, {
  3.5739049927574673`*^9, 3.573904993072507*^9}, {3.573918734880208*^9, 
  3.573918760874763*^9}, {3.573919150575371*^9, 3.573919156974297*^9}, {
  3.573919233696238*^9, 3.573919246259942*^9}, {3.573919489949943*^9, 
  3.5739195108920097`*^9}, {3.573920187578808*^9, 3.573920190509416*^9}, {
  3.573920457992897*^9, 3.573920461466565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onsite", "[", 
   RowBox[{"V_", ",", "c_", ",", "b_", ",", "L_", ",", "p_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "WE", ",", "WigPsi0", ",", "WigPsi1", ",", "Wig1", ",", "Wig2", ",", "x",
       ",", "U"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WE", " ", "=", " ", 
      RowBox[{"computePlaneMatrix2Well", "[", 
       RowBox[{"V", ",", "c", ",", "b", ",", "L", ",", "p"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"WE", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "10000"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"groundState1D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WE", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "12", ",", "x"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", ",", " ", 
       RowBox[{"take", " ", "the", " ", "eigenvectors"}], ",", " ", 
       RowBox[{
       "and", " ", "build", " ", "the", " ", "wannier", " ", "functions"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WigPsi0", " ", "[", "x_", "]"}], " ", "=", " ", 
      RowBox[{"groundState1D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WE", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "12", ",", "x"}], "]"}]}], ";", 
     "\n", 
     RowBox[{
      RowBox[{"WigPsi1", "[", "x_", "]"}], " ", "=", " ", 
      RowBox[{"groundState1D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WE", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "12", ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Check", " ", "normalization", " ", "of", " ", "the", " ", "ground", 
       " ", "and", " ", "excite", " ", "state"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Wig1", "[", "x_", "]"}], "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "+", 
         RowBox[{"Im", "[", 
          RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
       RowBox[{"Sqrt", "[", "2", "]"}]]}], ";", "\n", 
     RowBox[{
      RowBox[{"Wig2", "[", "x_", "]"}], "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"WigPsi0", "[", "x", "]"}], "]"}], "-", 
         RowBox[{"Im", "[", 
          RowBox[{"WigPsi1", "[", "x", "]"}], "]"}]}], ")"}], 
       RowBox[{"Sqrt", "[", "2", "]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"U", " ", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Wig1", "[", "x", "]"}], "4"], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "L"}], "/", "2"}], ",", 
          RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5739049339778824`*^9, 3.5739049916373315`*^9}, {
  3.573918902584927*^9, 3.573919015753026*^9}, {3.573919067350594*^9, 
  3.573919076550849*^9}, {3.573919140109489*^9, 3.573919146246747*^9}, {
  3.573919269436802*^9, 3.5739192852807703`*^9}, {3.573920140835112*^9, 
  3.573920171116066*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "Onsite", "]"}]], "Input",
 CellChangeTimes->{{3.5739189371866903`*^9, 3.5739189394489117`*^9}, {
  3.573919019338895*^9, 3.573919038560575*^9}, {3.573919084731183*^9, 
  3.5739190871318007`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WigMaker", "[", 
    RowBox[{"10", ",", ".5", ",", ".4", ",", "12", ",", "14"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.573919412140543*^9, 3.573919453391011*^9}, {
  3.5739195223345623`*^9, 3.573919526653679*^9}, {3.573920160010062*^9, 
  3.573920160889051*^9}}],

Cell[BoxData["0.02947573115228649`"], "Output",
 CellChangeTimes->{{3.573919468299015*^9, 3.573919527281087*^9}, 
   3.5739201614650307`*^9, 3.573920195548232*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1298, 961},
WindowMargins->{{Automatic, 14}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"9.0 for Linux x86 (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 71, 1, 45, "Input"],
Cell[631, 23, 92, 1, 45, "Input"],
Cell[726, 26, 510, 13, 75, "Input"],
Cell[1239, 41, 622, 14, 133, "Input"],
Cell[1864, 57, 203, 3, 104, "Input"],
Cell[2070, 62, 4016, 107, 596, "Input"],
Cell[6089, 171, 69, 1, 67, "Input"],
Cell[6161, 174, 1102, 31, 120, "Input"],
Cell[7266, 207, 221, 5, 67, "Input"],
Cell[CellGroupData[{
Cell[7512, 216, 94, 1, 67, "Input"],
Cell[7609, 219, 137, 2, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7783, 226, 532, 13, 78, "Input"],
Cell[8318, 241, 163, 3, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8518, 249, 438, 12, 78, "Input"],
Cell[8959, 263, 88, 1, 67, "Output"]
}, Open  ]],
Cell[9062, 267, 187, 4, 67, "Input"],
Cell[CellGroupData[{
Cell[9274, 275, 370, 11, 67, "Input"],
Cell[9647, 288, 93, 1, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9777, 294, 137, 2, 67, "Input"],
Cell[9917, 298, 72, 1, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10026, 304, 1900, 47, 433, "Input"],
Cell[11929, 353, 74, 1, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12040, 359, 1244, 31, 373, "Input"],
Cell[13287, 392, 1049, 22, 480, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14373, 419, 1158, 30, 373, "Input"],
Cell[15534, 451, 960, 21, 471, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16531, 477, 123, 2, 67, "Input"],
Cell[16657, 481, 114, 1, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16808, 487, 119, 2, 67, "Input"],
Cell[16930, 491, 93, 1, 67, "Output"]
}, Open  ]],
Cell[17038, 495, 96, 1, 67, "Input"],
Cell[CellGroupData[{
Cell[17159, 500, 1527, 38, 514, "Input"],
Cell[18689, 540, 1213, 25, 618, "Output"]
}, Open  ]],
Cell[19917, 568, 303, 7, 67, "Input"],
Cell[CellGroupData[{
Cell[20245, 579, 1591, 42, 253, "Input"],
Cell[21839, 623, 90, 1, 67, "Output"],
Cell[21932, 626, 1875, 45, 243, "Output"]
}, Open  ]],
Cell[23822, 674, 426, 10, 67, "Input"],
Cell[24251, 686, 5597, 124, 556, InheritFromParent],
Cell[29851, 812, 471, 12, 67, "Input"],
Cell[CellGroupData[{
Cell[30347, 828, 883, 26, 112, "Input"],
Cell[31233, 856, 1905, 47, 243, "Output"]
}, Open  ]],
Cell[33153, 906, 719, 20, 199, "Input"],
Cell[CellGroupData[{
Cell[33897, 930, 224, 5, 67, "Input"],
Cell[34124, 937, 260, 6, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34421, 948, 802, 22, 112, "Input"],
Cell[35226, 972, 1980, 41, 855, "Output"]
}, Open  ]],
Cell[37221, 1016, 298, 7, 67, "Input"],
Cell[CellGroupData[{
Cell[37544, 1027, 1885, 49, 199, "Input"],
Cell[39432, 1078, 2238, 47, 783, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41707, 1130, 661, 19, 112, "Input"],
Cell[42371, 1151, 1971, 37, 556, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44379, 1193, 122, 2, 181, "Section",
 InitializationCell->True],
Cell[44504, 1197, 176, 3, 114, "Text",
 InitializationCell->True],
Cell[44683, 1202, 588, 17, 118, "Input",
 InitializationCell->True],
Cell[45274, 1221, 1907, 52, 325, "Input",
 InitializationCell->True],
Cell[47184, 1275, 2264, 65, 378, "Input",
 InitializationCell->True],
Cell[49451, 1342, 2018, 56, 325, "Input",
 InitializationCell->True],
Cell[51472, 1400, 2955, 75, 543, "Input",
 InitializationCell->True],
Cell[54430, 1477, 2965, 89, 472, "Input",
 InitializationCell->True],
Cell[57398, 1568, 920, 26, 199, "Input",
 InitializationCell->True],
Cell[58321, 1596, 3292, 78, 598, "Input",
 InitializationCell->True],
Cell[61616, 1676, 1830, 53, 267, "Input",
 InitializationCell->True],
Cell[63449, 1731, 1861, 54, 267, "Input",
 InitializationCell->True],
Cell[65313, 1787, 214, 6, 114, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[65552, 1797, 179, 3, 67, "Input"],
Cell[65734, 1802, 143, 2, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65914, 1809, 148, 3, 67, "Input"],
Cell[66065, 1814, 173, 3, 67, "Output"]
}, Open  ]],
Cell[66253, 1820, 2606, 77, 585, "Input",
 InitializationCell->True],
Cell[68862, 1899, 1043, 36, 322, "Input",
 InitializationCell->True],
Cell[69908, 1937, 1786, 47, 339, "Input",
 InitializationCell->True],
Cell[71697, 1986, 1884, 50, 432, "Input",
 InitializationCell->True],
Cell[73584, 2038, 2067, 55, 394, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[75676, 2097, 128, 2, 67, "Input",
 InitializationCell->True],
Cell[75807, 2101, 253, 4, 67, "Output"]
}, Open  ]],
Cell[76075, 2108, 4918, 117, 798, "Input",
 InitializationCell->True],
Cell[80996, 2227, 3360, 90, 529, "Input",
 InitializationCell->True],
Cell[84359, 2319, 1206, 35, 360, "Input"],
Cell[85568, 2356, 1119, 28, 243, "Input"],
Cell[CellGroupData[{
Cell[86712, 2388, 139, 2, 100, "Subsection",
 InitializationCell->True],
Cell[86854, 2392, 798, 22, 150, "Input",
 InitializationCell->True],
Cell[87655, 2416, 167, 3, 67, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[87847, 2423, 616, 12, 67, "Input",
 InitializationCell->True],
Cell[88466, 2437, 413, 8, 67, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[88894, 2448, 118, 2, 67, "Input",
 InitializationCell->True],
Cell[89015, 2452, 669, 18, 156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[89709, 2474, 570, 10, 67, "Input",
 InitializationCell->True],
Cell[90282, 2486, 248, 4, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90567, 2495, 426, 12, 120, "Input",
 InitializationCell->True],
Cell[90996, 2509, 431, 11, 108, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[91442, 2523, 432, 8, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[91899, 2535, 371, 11, 120, "Input",
 InitializationCell->True],
Cell[92273, 2548, 559, 13, 108, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[92869, 2566, 171, 4, 67, "Input",
 InitializationCell->True],
Cell[93043, 2572, 357, 6, 67, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[93437, 2583, 729, 17, 120, "Input",
 InitializationCell->True],
Cell[94169, 2602, 677, 14, 108, "Output",
 InitializationCell->True]
}, Open  ]],
Cell[94861, 2619, 2993, 81, 619, "Input",
 InitializationCell->True],
Cell[97857, 2702, 126, 2, 67, "Input"],
Cell[97986, 2706, 4363, 114, 799, "Input",
 InitializationCell->True],
Cell[102352, 2822, 916, 26, 150, "Input",
 InitializationCell->True],
Cell[103271, 2850, 3333, 79, 633, "Input"],
Cell[CellGroupData[{
Cell[106629, 2933, 120, 2, 67, "Input"],
Cell[106752, 2937, 97, 1, 67, "Output"]
}, Open  ]],
Cell[106864, 2941, 201, 5, 67, "Input"],
Cell[107068, 2948, 3431, 96, 817, "Input"],
Cell[110502, 3046, 3026, 83, 670, "Input"],
Cell[CellGroupData[{
Cell[113553, 3133, 247, 5, 67, "Input"],
Cell[113803, 3140, 151, 3, 67, "Output"]
}, Open  ]],
Cell[113969, 3146, 1477, 36, 352, "Input"],
Cell[115449, 3184, 127, 2, 67, "Input"],
Cell[115579, 3188, 1385, 36, 330, "Input"],
Cell[116967, 3226, 3486, 90, 733, "Input"],
Cell[120456, 3318, 3459, 92, 742, "Input"],
Cell[123918, 3412, 233, 4, 67, "Input"],
Cell[CellGroupData[{
Cell[124176, 3420, 368, 8, 67, "Input"],
Cell[124547, 3430, 163, 2, 67, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
